{% extends "base.html" %}

{% block title %}ë‹¨ìˆœë³´ í•´ì„ - Simple Beam Analysis{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ë‹¨ìˆœë³´ í•´ì„ (Simple Beam)</h1>
    <p class="subtitle">Enter beam parameters and loads to run OpenSees analysis</p>
</div>

<!-- Input Mode Selector -->
<div class="mode-selector">
    <button type="button" class="mode-btn active" data-mode="natural" onclick="switchMode('natural')">
        <span class="mode-icon">ğŸ¤–</span>
        <span class="mode-label">ìì—°ì–´ ì…ë ¥</span>
        <span class="mode-desc">Claude AIê°€ í•´ì„</span>
    </button>
    <button type="button" class="mode-btn" data-mode="direct" onclick="switchMode('direct')">
        <span class="mode-icon">ğŸ“</span>
        <span class="mode-label">ì§ì ‘ ì…ë ¥</span>
        <span class="mode-desc">í¼ì— ê°’ ì…ë ¥</span>
    </button>
</div>

<!-- Natural Language Input Mode -->
<div id="natural-mode" class="input-mode active">
    <div class="form-section">
        <h2>ìì—°ì–´ë¡œ ë³´ ì„¤ëª…</h2>
        <p class="section-desc">ë³´ì˜ ê¸¸ì´, í•˜ì¤‘, ì§€ì§€ì¡°ê±´ ë“±ì„ ìì—°ì–´ë¡œ ì„¤ëª…í•˜ë©´ Claude AIê°€ í•´ì„ ì…ë ¥ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>

        <div class="form-group">
            <label for="natural-input">ë³´ ì„¤ëª…</label>
            <textarea id="natural-input" rows="4" placeholder="ì˜ˆ: ê¸¸ì´ 6m ë‹¨ìˆœë³´ì— ë“±ë¶„í¬í•˜ì¤‘ 20kN/m ì‘ìš©, H-400x200 ë‹¨ë©´ ì‚¬ìš©"></textarea>
        </div>

        <div class="example-prompts">
            <p><strong>ì˜ˆì‹œ:</strong></p>
            <ul>
                <li><a href="#" onclick="fillExample(1); return false;">"ê¸¸ì´ 8m ë‹¨ìˆœë³´, ë“±ë¶„í¬í•˜ì¤‘ 15kN/m, H-400x200"</a></li>
                <li><a href="#" onclick="fillExample(2); return false;">"5m ìº”í‹¸ë ˆë²„, ëë‹¨ì— ì§‘ì¤‘í•˜ì¤‘ 50kN"</a></li>
                <li><a href="#" onclick="fillExample(3); return false;">"10m ê³ ì •ë‹¨ ë³´, ì¤‘ì•™ ì§‘ì¤‘í•˜ì¤‘ 100kN, SS400 ê°•ì¬"</a></li>
            </ul>
        </div>

        <div class="form-actions">
            <button type="button" class="btn-secondary" id="parse-btn" onclick="parseNaturalLanguage()">
                Claudeë¡œ ë³€í™˜
            </button>
            <button type="button" class="btn-primary btn-lg" id="natural-submit-btn" onclick="submitNatural()">
                í•´ì„ ì‹¤í–‰
            </button>
        </div>

        <!-- Parsed preview -->
        <div id="parsed-preview" class="parsed-preview" style="display: none;">
            <h3>ë³€í™˜ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°</h3>
            <pre id="parsed-json"></pre>
            <button type="button" class="btn-secondary btn-sm" onclick="editParsed()">ì§ì ‘ ì…ë ¥ìœ¼ë¡œ ìˆ˜ì •</button>
        </div>

        <div id="parse-error" class="error-message" style="display: none;"></div>
        <div id="api-warning" class="warning-message" style="display: none;">
            Claude API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì§ì ‘ ì…ë ¥ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
        </div>
    </div>
</div>

<!-- Direct Input Mode -->
<div id="direct-mode" class="input-mode">
    <form id="analysis-form" class="analysis-form">
        <!-- Geometry Section -->
        <section class="form-section">
            <h2>Geometry</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="span">Span Length (m)</label>
                    <input type="number" id="span" name="span" value="6.0" step="0.1" min="0.1" required>
                </div>
                <div class="form-group">
                    <label for="support_type">Support Type</label>
                    <select id="support_type" name="support_type">
                        <option value="simple" selected>ë‹¨ìˆœì§€ì§€ (Simple)</option>
                        <option value="cantilever">ìº”í‹¸ë ˆë²„ (Cantilever)</option>
                        <option value="fixed_fixed">ì–‘ë‹¨ê³ ì • (Fixed-Fixed)</option>
                        <option value="fixed_pin">ê³ ì •-í•€ (Fixed-Pin)</option>
                        <option value="propped_cantilever">ì§€ì§€ ìº”í‹¸ë ˆë²„ (Propped)</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- Sections & Material -->
        <section class="form-section">
            <h2>Section & Material</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="section_name">Section</label>
                    <select id="section_name" name="section_name">
                        <option value="H-400x200x8x13" selected>H-400x200x8x13</option>
                        <option value="H-500x200x10x16">H-500x200x10x16</option>
                        <option value="H-350x175x7x11">H-350x175x7x11</option>
                        <option value="H-300x150x6.5x9">H-300x150x6.5x9</option>
                        <option value="H-600x200x11x17">H-600x200x11x17</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="material_name">Material</label>
                    <select id="material_name" name="material_name">
                        <option value="SS275" selected>SS275 (KS)</option>
                        <option value="SS400">SS400 (KS)</option>
                        <option value="SM490">SM490 (KS)</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="num_elements">Number of Elements</label>
                    <select id="num_elements" name="num_elements">
                        <option value="10">10</option>
                        <option value="20" selected>20 (recommended)</option>
                        <option value="40">40</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="deflection_limit">Deflection Limit (L/n)</label>
                    <select id="deflection_limit" name="deflection_limit">
                        <option value="250">L/250</option>
                        <option value="300" selected>L/300</option>
                        <option value="360">L/360</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- Load Section -->
        <section class="form-section">
            <h2>Loads</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="load_type">Load Type</label>
                    <select id="load_type" name="load_type" onchange="updateLoadInputs()">
                        <option value="uniform" selected>ë“±ë¶„í¬í•˜ì¤‘ (Uniform)</option>
                        <option value="point_center">ì¤‘ì•™ ì§‘ì¤‘í•˜ì¤‘ (Point at Center)</option>
                        <option value="point">ì„ì˜ ì§‘ì¤‘í•˜ì¤‘ (Point Load)</option>
                        <option value="triangular">ì‚¼ê°í˜• í•˜ì¤‘ (Triangular)</option>
                        <option value="partial_uniform">ë¶€ë¶„ ë“±ë¶„í¬ (Partial Uniform)</option>
                    </select>
                </div>
            </div>

            <div id="load-inputs">
                <!-- Uniform load (default) -->
                <div class="form-row" id="uniform-inputs">
                    <div class="form-group">
                        <label for="load_value">Load Value (kN/m)</label>
                        <input type="number" id="load_value" name="load_value" value="20" step="0.1">
                    </div>
                </div>

                <!-- Point load inputs (hidden by default) -->
                <div class="form-row" id="point-inputs" style="display: none;">
                    <div class="form-group">
                        <label for="point_load_value">Point Load (kN)</label>
                        <input type="number" id="point_load_value" name="point_load_value" value="50" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="point_location">Location from Left (m)</label>
                        <input type="number" id="point_location" name="point_location" value="3.0" step="0.1">
                    </div>
                </div>

                <!-- Partial uniform inputs (hidden by default) -->
                <div class="form-row" id="partial-inputs" style="display: none;">
                    <div class="form-group">
                        <label for="partial_load_value">Load Value (kN/m)</label>
                        <input type="number" id="partial_load_value" name="partial_load_value" value="20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="load_start">Start (m)</label>
                        <input type="number" id="load_start" name="load_start" value="1.0" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="load_end">End (m)</label>
                        <input type="number" id="load_end" name="load_end" value="5.0" step="0.1">
                    </div>
                </div>
            </div>
        </section>

        <!-- Submit -->
        <div class="form-actions">
            <button type="submit" class="btn-primary btn-lg" id="submit-btn">
                Run Analysis
            </button>
        </div>
    </form>
</div>

<!-- Job status area -->
<div id="job-status-area"></div>
{% endblock %}

{% block scripts %}
<script src="/static/js/simple_beam_form.js"></script>
{% endblock %}
